I'll analyze the current project structure and the GitHub issue to understand the migration plan from classic csproj to modern SDK-style csproj, then identify potential conflicts with the existing CI/CD pipeline.

Read file: simple-.net-Crypting-For-PowerBuilder.sln
Now let me check the current packages.config files to understand the dependency management:

Ran tool
Read file: net481PB/packages.config
Read file: net481SQL-server/packages.config
Now let me check the nuget.config file to understand the current package source configuration:

Read file: nuget.config
Let me also check the restore-packages.ps1 script to understand the current package restoration process:

Read file: restore-packages.ps1
Now let me check the source code files to understand the current structure:

Read file: net481PB/draft.cs
Now let me check the SQL server project structure:

Read file: net481SQL-server/draft.cs
Now let me check the NET8 project structure:

Read file: NET8/draft.cs
Based on my analysis of the current project structure and the GitHub issue, here's my comprehensive plan for migrating from classic csproj to SDK-style csproj:

## Current State Analysis

**Current Structure:**
- **NET8 project**: Already uses SDK-style csproj (modern)
- **net481PB project**: Uses classic csproj format with packages.config
- **net481SQL-server project**: Uses classic csproj format with packages.config
- **CI/CD**: Uses MSBuild for .NET Framework projects and dotnet CLI for NET8

## Migration Plan

### Phase 1: Convert .NET Framework Projects to SDK-Style

#### 1.1 Convert SecureLibrary-PB.csproj
**Current Issues:**
- Uses classic csproj format with `packages.config`
- Manual package references with hardcoded paths
- Complex conditional compilation for test exclusion

**Target SDK-Style Format:**
```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net481</TargetFramework>
    <AssemblyName>SecureLibrary</AssemblyName>
    <RootNamespace>SecureLibrary</RootNamespace>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <ComVisible>true</ComVisible>
    <IsTestProject>true</IsTestProject>
    <ExcludeTests Condition="'$(Configuration)'=='Release'">true</ExcludeTests>
  </PropertyGroup>
  
  <PropertyGroup Condition="'$(Configuration)'=='Release' and '$(ExcludeTests)'=='true'">
    <DefineConstants>TRACE;RELEASE;RELEASE_WITHOUT_TESTS</DefineConstants>
    <IsTestProject>false</IsTestProject>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="BCrypt.Net-Next" Version="4.0.3" />
    <PackageReference Include="System.Buffers" Version="4.5.1" />
    <PackageReference Include="System.Memory" Version="4.5.4" />
    <PackageReference Include="System.Numerics.Vectors" Version="4.5.0" />
    <PackageReference Include="System.Runtime.CompilerServices.Unsafe" Version="4.5.3" />
  </ItemGroup>

  <ItemGroup Condition="'$(Configuration)'!='Release'">
    <PackageReference Include="NUnit" Version="4.1.0" />
    <PackageReference Include="NUnit3TestAdapter" Version="4.6.0" />
  </ItemGroup>
</Project>
```

#### 1.2 Convert SecureLibrary-SQL.csproj
**Target SDK-Style Format:**
```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net481</TargetFramework>
    <AssemblyName>SecureLibrary.SQL</AssemblyName>
    <RootNamespace>SecureLibrary.SQL</RootNamespace>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <IsTestProject>true</IsTestProject>
    <ExcludeTests Condition="'$(Configuration)'=='Release'">true</ExcludeTests>
  </PropertyGroup>
  
  <PropertyGroup Condition="'$(Configuration)'=='Release' and '$(ExcludeTests)'=='true'">
    <DefineConstants>TRACE;RELEASE;RELEASE_WITHOUT_TESTS</DefineConstants>
    <IsTestProject>false</IsTestProject>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="BCrypt.Net-Next" Version="4.0.3" />
    <PackageReference Include="System.Buffers" Version="4.5.1" />
    <PackageReference Include="System.Memory" Version="4.5.4" />
    <PackageReference Include="System.Numerics.Vectors" Version="4.5.0" />
    <PackageReference Include="System.Runtime.CompilerServices.Unsafe" Version="4.5.3" />
    <PackageReference Include="Microsoft.SqlServer.Server" Version="1.0.0" />
  </ItemGroup>

  <ItemGroup Condition="'$(Configuration)'!='Release'">
    <PackageReference Include="NUnit" Version="3.13.3" />
    <PackageReference Include="NUnit3TestAdapter" Version="4.4.2" />
  </ItemGroup>
</Project>
```

### Phase 2: Update CI/CD Pipeline

#### 2.1 CI Pipeline Updates (ci.yaml)
**Current Issues:**
- Uses `nuget restore` for classic projects
- Manual package copying between directories
- Mixed build commands (MSBuild + dotnet)

**Required Changes:**
```yaml
# Replace nuget restore with dotnet restore
- name: Restore dependencies
  run: dotnet restore simple-.net-Crypting-For-PowerBuilder.sln

# Remove manual package copying (no longer needed)
# - name: Copy dependencies
#   run: |
#     Copy-Item -Path ${{ github.workspace }}\packages -Destination ${{ github.workspace }}\net481pb -Recurse
#     Copy-Item -Path ${{ github.workspace }}\packages -Destination ${{ github.workspace }}\net481SQL-server -Recurse

# Update build commands to use dotnet build
- name: Build solution for testing
  run: dotnet build "simple-.net-Crypting-For-PowerBuilder.sln" --configuration Debug
```

#### 2.2 CD Pipeline Updates (cd.yaml)
**Current Issues:**
- Uses MSBuild for .NET Framework projects
- Manual package copying
- Complex ILMerge/ILRepack commands with hardcoded paths

**Required Changes:**
```yaml
# Replace MSBuild with dotnet build
- name: Build solution for release
  run: dotnet build "simple-.net-Crypting-For-PowerBuilder.sln" --configuration Release

# Update publish command for NET8
- name: Publish NET8 project
  run: dotnet publish "NET8/NET8.csproj" --configuration Release --arch x64 --self-contained false

# Update ILMerge paths to use SDK-style output paths
- name: Merge and Create Release Files
  run: |
    # Update paths to use SDK-style output directories
    ilrepack /out:${{ github.workspace }}\net481PB\bin\Release\net481\SecureLibrary-PB-Merged.dll `
               /lib:${{ github.workspace }}\net481PB\bin\Release\net481 `
               /targetplatform:"v4,C:\Windows\Microsoft.NET\Framework\v4.0.30319" `
               /union `
               /copyattrs `
               /internalize `
               ${{ github.workspace }}\net481PB\bin\Release\net481\SecureLibrary.dll `
               # ... other DLLs
```

### Phase 3: Update Solution File

**Current Issues:**
- Solution file is compatible but may need updates for SDK-style projects

**Required Changes:**
- Update project GUIDs if needed
- Ensure all projects are properly referenced
- Verify build configurations

### Phase 4: Clean Up Legacy Files

**Files to Remove:**
- `packages.config` files (both projects)
- `restore-packages.ps1` (no longer needed)
- Manual package copying in CI/CD
- Legacy `packages/` directory structure

### Phase 5: Testing and Validation

#### 5.1 Local Testing
- Verify all projects build locally
- Run unit tests for all projects
- Test COM interop functionality
- Test SQL Server CLR integration

#### 5.2 CI/CD Testing
- Test CI pipeline with SDK-style projects
- Verify package restoration works
- Test build and test execution
- Validate CD pipeline with merged DLLs

## Potential Conflicts and Solutions

### 1. **AssemblyInfo.cs Files**
**Issue:** SDK-style projects auto-generate assembly info
**Solution:** Remove manual AssemblyInfo.cs files or use `<GenerateAssemblyInfo>false</GenerateAssemblyInfo>`

### 2. **Output Path Changes**
**Issue:** SDK-style projects use different output paths
**Solution:** Update CI/CD paths from `bin\Release\` to `bin\Release\net481\`

### 3. **Package Reference Conflicts**
**Issue:** Different NUnit versions between projects
**Solution:** Standardize NUnit versions across all projects

### 4. **COM Interop Settings**
**Issue:** COM visibility settings may need adjustment
**Solution:** Ensure `<ComVisible>true</ComVisible>` is set in SDK-style projects

### 5. **SQL Server CLR Integration**
**Issue:** SQL Server CLR projects may need special configuration
**Solution:** Add `<EnableComHosting>false</EnableComHosting>` and verify CLR support

## Implementation Steps

1. **Create backup branches** for each project
2. **Convert one project at a time** (start with SecureLibrary-PB)
3. **Test locally** after each conversion
4. **Update CI/CD** incrementally
5. **Validate all functionality** before merging
6. **Clean up legacy files** after successful migration

This migration will modernize the build system, improve dependency management, and make the project more maintainable while preserving all existing functionality.